---
layout: post
title: "dplyr HOW-TO"
permalink: dplyr-how-to
---

Шпаргалка возможностей пакета `dplyr`. 

# Содержание

1. [all.equal](#all.equal)
2. [arrange](#arrange)

# Общее

Пакет `dplyr` за авторством вездесущего Hadley Wickham'а является идейным наследником и продолжателем пакета `plyr` и предназначен для работы с `data.frame`'ами. Основная задача `dplyr` упростить рутинные действия при анализе данных (subsetting, sorting и т.п.) на которые уходит лишее время, ускорить работу за счет реализации узких мест на C++ и предоставить пользователям унифицированный интерфейс для работы с данными, вне зависимости от их формата. На данный момент `dplyr` заслужил огромную популярность в R-сообществе и если вас по той или иной причине он не вдохновляет, то ознакомиться с его функциями стоит в любом случае, чтобы иметь возможность "читать" чужой код.
```{r message=FALSE}
library(dplyr)
```

# Полезные ссылки

- [github dplyr](https://github.com/hadley/dplyr)
- [github magrittr](https://github.com/smbache/magrittr)
- [dplyr tutorial](https://www.dropbox.com/sh/i8qnluwmuieicxc/AAAgt9tIKoIm7WZKIyK25lh6a)

<a name="all.equal"></a>
# all.equal()

## Назначение

Развитие `all.equal` для сравения между собой `data.frame`'ов

## Использование

```
all.equal(target, current, ignore_col_order = TRUE,
          ignore_row_order = TRUE, convert = FALSE, ...)
```

## Аргументы

- `target`, `current` - два `data.frame` для сравнения
- `ignore_col_order` - игнорировать порядок столбцов
- `ignore_row_order` - игнорировать порядок строк
- `convert` - изменять класс схожих объектов (`factor` в `character`, `integer` в `double`)

## Примеры использования

Возвращает `TRUE`, если объекты идентичны:
```{r}
all.equal(mtcars, mtcars)
```

Возвращает `atomic character vector` с отличиями:
```{r}
mtcars_df <- tbl_df(mtcars)
mtcars_df.rand <- mtcars_df[sample(nrow(mtcars_df)), sample(ncol(mtcars_df))]
all.equal(mtcars, mtcars_df.rand)
```

Учитыая порядок столбцов:
```{r}
all.equal(mtcars_df, mtcars_df.rand, ignore_col_order = FALSE)
```

Учитывая порядок строк:
```{r}
all.equal(mtcars_df, mtcars_df.rand, ignore_row_order = FALSE)
```

<a name="arrange"></a>
# arrange()

## Назначение

Сортирует `data.frame` по указанной переменной

## Использование

```
arrange(data, ...)
```

## Аргументы

- `data` - `data.frame`

## Примеры использования

Сортируем набор данных `mtcars` по переменным `cyl` и `disp`:
```{r}
mtcars %>%
  arrange(cyl, disp) %>%
  head()
```

Сортируем набор данных `mtcars` по переменной `disp` в порядке уменьшения:
```{r}
mtcars %>%
  arrange(desc(disp)) %>%
  head()
```

Сортируем набор даных `iris` по разнице между `Sepal.Length` и `Petal.Length` у цветка:
```{r}
iris %>%
  arrange(Sepal.Length - Petal.Length) %>%
  head()
```

<a name="as.tbl_cube"></a>
# as.tbl_cube()

## Назначение

Конвертирует объект в `tbl_cube` 

## Использование

```
as.tbl_cube(x, ...)
```

## Аргументы

- `x` - `data.frame`

## Примеры использования

`array`:
```{r}
Titanic %>%
  as.tbl_cube() %>%
  as.data.frame() %>%
  head()
```
